{% import "bootstrap/wtf.html" as wtf %}

<div id="sampleid" style="display: none">{{ sample.id }}</div>
<h1 class="page-header">
    Actions: Sample <b id="{{ sample.id }}" class="{% if sample.owner == current_user %}editsamplename{% endif %}" style="display: inline">{{ sample.name }}</b> | Type: <b id="{{ sample.id }}" class="{% if sample.owner == current_user %}selectsampletype{% endif %}" style="display: inline">{{ sample.sampletype.name }}</b>
    {% if sample.owner == current_user %}<button class="btn btn-default" data-href="/delsample/{{ sample.id }}" style="margin-left:5em" data-type="sample" data-id="{{ sample.id }}" data-toggle="modal" data-target="#confirm-delete">Delete</button>{% endif %}
    <button class="btn btn-default" id="matrixviewbutton">Matrix View</button>
</h1>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-3">
            <img id="sampleimage" src="{% if sample.image != None %}{{ sample.image }}{% endif %}" width="100%">{% if sample.owner == current_user %}<button class="btn btn-default" data-toggle="modal" data-target="#browser">Browse</button>{% endif %}
        </div>
        <div class="col-md-6">
            Sample description:
        </div>
        <div class="col-md-3">
            <strong>Shared with:</strong><p>&nbsp;</p>
            <div class="container-fluid" id="sharelist">
                {% for share in shares %}
                    <div class="row" id="sharelistentry{{ share.user.id }}">
                        <div class="col-md-10">{{ share.user.username }}</div><div class="col-md-2">{% if sample.owner == current_user or share.user == current_user %}<button class="removeshare btn btn-danger" id="{{ share.user.id }}">X</button>{% endif %}</div>
                    </div>
                {% endfor %}
            </div><p>&nbsp;</p>
            {% if sample.owner == current_user %}<button class="btn btn-default" data-toggle="modal" data-target="#userbrowser">Add share</button>{% endif %}
        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="row list-header">
        <div class="col-md-2">Date</div>
        <div class="col-md-1">User</div>
        <div class="col-md-2">Type</div>
        <div class="col-md-7">Description</div>
    </div>
    {% for action in actions %}
    <div class="row list-entry" id="{{ action.id }}">
        <div id="{{ action.id }}" class="col-md-2 {% if action.owner == current_user %}editactiondate{% endif %}">{{ action.timestamp }}</div>
        <div id="{{ action.id }}" class="col-md-1">{{ action.owner.username }}</div>
        <div id="{{ action.id }}" class="col-md-2 {% if action.owner == current_user %}selectactiontype{% endif %}" style="display: inline">{{ action.actiontype.name }}</div>
        <div id="{{ action.id }}" class="col-md-6 {% if action.owner == current_user %}editactiondescription {% endif %}">{{ action.description|safe }}</div>
        <div class="col-md-1">{% if action.owner == current_user %}<button class="btn btn-default" data-type="action" data-id="{{ action.id }}" data-toggle="modal" data-target="#confirm-delete">Delete</button>{% endif %}</div>
    </div>
    {% endfor %}
    <div class="row list-entry">
        <form id="newactionform">
            {{ form.hidden_tag() }}
            <div class="col-md-2">{{ wtf.form_field(form.timestamp) }}</div>
            <div class="col-md-2">{{ wtf.form_field(form.actiontype) }}</div>
            <div class="col-md-7">{{ wtf.form_field(form.description) }}</div>
            <div class="col-md-1">{{ wtf.form_field(form.submit) }}</div>
        </form>
    </div>
</div>

