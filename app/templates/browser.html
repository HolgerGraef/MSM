{% extends "bootstrap/base.html" %}

{% block styles %}
{{super()}}
<link rel="stylesheet" href="{{url_for('static', filename='browser.css')}}">
{% endblock %}

{% block title %}Browser{% endblock %}

{% block content %}
<div id="browser-frame">
    {% if address == '' or address is not defined %} {# only display the upload section when we are in "root" #}
        <div id="upload-frame">
            <form method="post" action="#" style="margin:0;padding:0;" enctype="multipart/form-data" id="uploadform">
                <img class="upload" src="{{url_for('static', filename='upload.png')}}" width="48px" height="48px">
                <strong>Upload an image:&nbsp;&nbsp;&nbsp;&nbsp;</strong>
                <input style="display:inline;" type="file" name="file" id="file">
                <input style="display:inline;" type="submit" value="OK">
            </form>
        </div>
        <hr>
    {% endif %}
    <div id="address"><strong>Network shares{% if address != '' %} | Path: {% endif %}</strong>{{ address }}</div>

    {% for resource in resources %}
        <div>
        <img src="{{ url_for('static', filename='resource.png') }}" {% if resource.available %}class="folder"{% endif %} data-url="{{ resource.name }}" width="48px" height="48px">
        {{ resource.name }}
        {% if resource.hasuserfolder %}
            <img src="{{ url_for('static', filename='user.png') }}" class="folder" data-url="{{ resource.name+"/"+owner.username }}" width="48px" height="48px">
        {% endif %}
        {% if resource.hassamplefolder %}
            <img src="{{ url_for('static', filename='sample.png') }}" class="folder" data-url="{{ resource.name+"/"+owner.username+"/"+sample.name }}" width="48px" height="48px">
        {% endif %}
        </div>
    {% endfor %}
    <div>
        <div class="folders">
            {% for folder in folders %}
                <div class="folder" data-url="{{ address }}{% if address!='' %}/{% endif %}{{ folder.name }}{{ folder.ext }}">
                    <img src="{{ folder.image }}">
                    <span>{{ folder.name }}{{ folder.ext }}</span>
                </div>
            {% endfor %}
        </div>
        <div class="files">
            {% for file in files %}
                <div class="file">
                <img src="{{ file.image }}">
                <span>{{ file.name }}{{ file.ext }}</span>
                </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
    {{ super() }}
    <script src="{{ url_for('static', filename='browser.js') }}"></script>
    <script type="text/javascript" charset="utf-8">
        $(function() { $(document).ready(function () {
            {# Check if an upload has failed. #}
            {% if uploadfailed is defined and uploadfailed %}
                alert("Upload failed: {{ errormessage }}. The following extensions are accepted: {{ extensions }}");
            {% else %}
                {# Check if an upload has succeeded #}
                {% if uploadurl is defined %}
                    terminate_browser("{{ uploadurl }}");
                {% else %}
                    init_browser();
                {% endif %}
            {% endif %}
        });});
    </script>
{% endblock %}
